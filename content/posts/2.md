---
title: 2
date: 2021-02-04T14:30:58+05:30
lastmod: 2021-02-04T14:30:58+05:30
author: Abhishek Ranjan
# avatar: /img/author.jpg
# authorlink: https://author.site
cover: /img/cover.jpg
categories:
  - category1
tags:
  - tag1
  - tag2
draft: true
---

Cut out summary from your post content here.

<!--more-->

## Hosting with AWS (Amazon Linux 2 AMI)

##### Prerequisite

- **[AWS Account](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/get-set-up-for-amazon-ec2.html)**.
- **[SSH Client](https://phoenixnap.com/kb/generate-ssh-key-windows-10)**.
- **[Launch your EC2 Instance (Amazon Linux 2 AMI)](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/launching-instance.html)**.
##### Connect to your Linux instance using an SSH client -
1. Open terminal (CMD), we will be using the ssh command to connect to the instance. Copy the path and file name of the private key (.pem) which was downloaded when launching your EC2 instance, the user name for your instance, and the public DNS name or IPv6 address for your instance can be found at your EC2 dashboard. To connect to your instance, use the following command.
![SSH TO EC2](/img/AWS/1.jpg)

```html
ssh -i (Full Path Of .pem File) ec2-user@(Your EC2 Public IPv4 Address)
```
#### You will see a response like the following:
> The authenticity of host 'ec2-198-51-100-1.compute-1.amazonaws' (198-51-100-1) 
can't be established.
ECDSA key fingerprint is l4UB/neBad9tvkgJf1QZWxheQmR59WgrgzEimCG6kZY.
Are you sure you want to continue connecting (yes/no)?

**Enter Yes**
##### CONGRATES YOU ARE LOGGED INTO OUR AWS LINUX INSTANCE 
***

2. Type **sudo su** to get admin(root) access
3. Next we will check for any update by **yum update -y**
```html
sudo su
yum update -y
```
4. Clone the repo to be deployed from github | bitbucket (any version-control system) or you can also copy your repo from AWS S3 bucket.
```html
git clone git@github.com:iamabhi222/repo_address
```
5. Change to your cloned directory by **cd repo_address**
6. Install all your dependencies from package.json by **npm install**
```html
cd repo_address
npm install
```
7. Now we will need Apache2 web server that will act as a reverse proxy for our nodejs server, install apache2(httpd) by **yum install -y httpd.x86_64**
8. Lets start the apache(httpd) service by **systemctl start httpd.service** and to enable the service to remain active across reboots type **systemctl enable httpd.service** after this the httpd service will be active on port 80 you can ping the server by **curl http://localhost:80**
```html
yum install -y httpd.x86_64
systemctl start httpd.service
systemctl enable httpd.service
curl http://localhost:80 (to ping the server)
```
9. Now we need to change the inbound rules of our EC2 Instance Security Group that will allow http traffic on port 80 into our EC2 instance. [Article](https://aws.amazon.com/premiumsupport/knowledge-center/connect-http-https-ec2/)
After changing the rules you can visit your apache2 default page at **http://(Your-EC2-Public-IPv4-Address)**
![APACHE DEFAULT](/img/AWS/2.png)
10. Now that now that our apache serve is active lets start our nodejs serve but before that we will install **pm2** which is a process manager for node.js applications with a build-in load balance,it allows you to keep applications alive forever, after that we will start our node.js by **pm2 star (file-name)**,you can view the status of your node server by **pm2 list*
```html
To check if the inbound rules for http are changed 
successfully visit - 
http://13.127.68.26:80/ or http://13.127.68.26/
(port 80 is the default port for http)
npm - pm2 -g
pm2 start index.js
pm2 list (To check all active servers)
```

#### After all this, We have our Apache (httpd) and Node server running on port 80 and 3000* Respectively!
****
11. Next we have to set up reverse proxy that will point to our node.js server. So, let's open httpd's config file by **sudo vim /etc/httpd/conf/httpd.conf** and add following lines that we proxy all incoming reqests at port 80 to port 3000 -
***
> ProxyPass "/"  "http://13.127.68.26:3000/"
ProxyPassReverse "/"  "http://13.127.68.26:3000/"
***
```html
sudo vim /etc/httpd/conf/httpd.conf
ProxyPass "/"  "http://13.127.68.26:3000/"
ProxyPassReverse "/"  "http://13.127.68.26:3000/"
```
12. After this we need to restart our apache server by **apachectl -k restart** and BOOM!! we are ready to go, the site will be live at **http://13.127.68.26** . Next you can change your domain's DNS settings to point to your EC2 ip address.

##### Key Points -
- Clone the repo.
- Install Apache2
- Change your EC2 Security Group to allow inbound http traffic at port 80
- Install PM2 and start your Node.js Server
- Edit the config file of httpd and add proxy settings
- Restart Apache
- Visit your EC2 Public IP4 Address in browser!!

